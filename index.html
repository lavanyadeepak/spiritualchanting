<!DOCTYPE HTML>
<!--
	Hyperspace by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Chanting Utility</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<!--[if lte IE 8]><script src="assets/js/ie/html5shiv.js"></script><![endif]-->
		<link rel="stylesheet" href="assets/css/main.css" />
		<!--[if lte IE 9]><link rel="stylesheet" href="assets/css/ie9.css" /><![endif]-->
		<!--[if lte IE 8]><link rel="stylesheet" href="assets/css/ie8.css" /><![endif]-->
		<link href="./css/jplayer.css" rel="stylesheet" type="text/css" />
		<link href="./css/jquery-ui-1.8.24.custom.css" rel="stylesheet" type="text/css" />

        <style type="text/css">
            select,input, #divTime{
                background-color:#5E42A6;
                color:white;
            }
        </style>

	</head>
	<body>

		<!-- Sidebar -->
			<section id="sidebar">
				<div class="inner">
					<nav>
						<ul>
							<li><a href="#intro">Chanting</a></li>
                            <li><a href="#two">History</a></li>
							<li><a href="#three">Get in touch</a></li>
						</ul>
					</nav>
				</div>
			</section>

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Intro -->
					<section id="intro" class="wrapper style1 fullscreen fade-up">
						<div class="inner">
									<div id="contact-form" class="clearfix">
										<label for="name">Chant: </label>
										<Select Id="drpChant" name="drpChant">
										  
										</Select>
													
										<br>			
										<label for="email">Chant Count</label>
										<Select Id="intCount" name="intCount" style="display:none;">
										  <Option Value="1">1</Option>
										  <Option Value="9">9</Option>
										  <Option Value="11">11</Option>
										  <Option Value="27">27</Option>
										  <Option Value="54">54</Option>
										  <Option Value="108">108</Option>
										  <Option Value="1008">1008</Option>
										</Select>
					
                                        
                                        <input type="number" min="1" max="20" step="1" value="1" id="txtCount" name="txtCount" required>
			
										<span id="loading"></span>
						 
                                        <div id="divTime" style="display:none;">
                                            <div id="diveJapaMala"></div><br />
										    <b>Start Time:</b> <span id="divTimeStart"></span><br>
										    <span id="spnStopTime" style="display:none;"><b>Stop Time:</b> <span id="divTimeStop"></span></span>
										</div>
										
										<br><br>
											
										<input type="button" value="Submit" id="btnSubmit" />
											
										</div>
										
												<section>
													<div id="jquery_jplayer"></div>
													<div id="jplayer_inspector"></div>
												</section>
						</div>
					</section>

				<!-- One -->
                <section id="two" class="wrapper style1 fade-up" style="color:white;">
                    <div class="inner" style="padding-top:25%;">
                        This small Jquery/JPlayer Utility, I humbly hope, would help people to do their chanting efficiently. 
                        I dedicate this to the service of SSRF Inc. and attribute credits to my gurudev (Shanidev) for helping me get this in place on the first day of Mahalaya Paksham 2012.<br /><br />

                        Definitely there is no copyright infringements or commercial benefits to the publisher or the host. We have tried to gather the media from available public domain for the benefit of the community.<br /><br />

                        We have used HTML5/JQuery technology that is best rendered on Google Chrome and latest versions of Internet Explorer and Firefox. Mobile devices of similar family should render them fine as well.
                    </div>
                </section>


				<!-- Three -->
					<section id="three" class="wrapper style1 fade-up" style="color:white;">
						<div class="inner" style="padding-top:10%;">
							<h2>Get in touch</h2>
							<p>deepak.vasudevan (at) outlook.com</p>
							
							<h2>Web Hosting Courtesy</h2>
							<p>
							   <Ul>
                                  <li><a href="http://www.000webhost.com/">000WebHost</a></li>
                                </Ul>
							</p>
							
							<h2>Media Sponsors</h2>
							<p>
							  SSRF
							</p>

							<h2>Download Source Code</h2>
							<p>
							  You can download the source code of this utility for offline viewing and customization <a href="https://github.com/lavanyadeepak/spiritualchanting">here</a>.
							</p>							
						</div>
					</section>

			</div>

		<!-- Footer -->
			<footer id="footer" class="wrapper style1-alt">
				<div class="inner">
					<ul class="menu">
						<li>&copy; Untitled. All rights reserved.</li><li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
					</ul>
				</div>
			</footer>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="scripts/jquery-migrate-1.4.1.js"></script>
			<script src="scripts/lodash.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/skel.min.js"></script>
			<script src="assets/js/util.js"></script>
			<!--[if lte IE 8]><script src="assets/js/ie/respond.min.js"></script><![endif]-->
			<script src="assets/js/main.js"></script>
			<script type="text/javascript" src="./scripts/jquery.jplayer.min.js"></script>
			<script type="text/javascript" src="./scripts/jplayer.playlist.min.js"></script>
			<script type="text/javascript" src="./scripts/jquery.jplayer.inspector.js"></script>
			<script type="text/javascript" src="./scripts/jquery-ui-1.8.24.custom.min.js"></script>
            <script type="text/javascript" src="./scripts/jquery.blockUI.js"></script>
			<script type="text/javascript" src="./chant.json"></script>
			<script type="text/javascript">
                var chantLimit = 0;
                var chantCount = 0;
                var my_jPlayer;
                var chantJson;
				
				var intPlayListCount = 0;
				var intCurrentPlay = 0;
				
				var myPlaylist;

			   $(function (){
			   
			   	my_jPlayer = $("#jquery_jplayer");
				
				chantJson.chant = _.sortBy(chantJson.chant, "chantname");
				
				for (var i in chantJson.chant) {
					$("#drpChant").append("<option value='" + chantJson.chant[i].chanturl + "'>" + chantJson.chant[i].chantname + "</option>");
				}

			   	/*$.ajax({
			   	    dataType: "json",
			   	    url: "chant.json",
			   	    success: function (result) {
			   	        
						chantJson = result;
						
						chantJson.chant = _.sortBy(chantJson.chant, "chantname")
						
			   	       
			   	        for (var i in chantJson.chant) {
			   	            $("#drpChant").append("<option value='" + chantJson.chant[i].chanturl + "'>" + chantJson.chant[i].chantname + "</option>");
			   	        }
			   	    }
			   	});
				*/
				  
	            // Some options
	            var	opt_play_first = false, // If true, will attempt to auto-play the default track on page loads. No effect on mobile devices, like iOS.
		            opt_auto_play = true, // If true, when a track is selected, it will auto-play.
		            opt_text_playing = "Now playing", // Text when playing
		            opt_text_selected = "Track selected"; // Text when not playing

	            // A flag to capture the first track
	            var first_track = true;

	            // Change the time format
	            $.jPlayer.timeFormat.padMin = false;
	            $.jPlayer.timeFormat.padSec = false;
	            $.jPlayer.timeFormat.sepMin = " min ";
	            $.jPlayer.timeFormat.sepSec = " sec";

	            // Instance jPlayer
	            my_jPlayer.jPlayer({
	                errorAlerts: true,
					volume: "0.9",
		            ready: function () {
		            },
		            timeupdate: function(event) {
		
		            },
		            play: function(event) {
					   FormatText();
					   intCurrentPlay++;
		            },
		            pause: function(event) {
		
		            },
		            ended: function(event) {
					    if ($("#hidModeOfProcessing").val() == "Normal")
						{
								if (chantCount < chantLimit)
							   {
									my_jPlayer.jPlayer("play");		   
									FormatText();
							   }		   	
							   else
							   {
								  chantLimit = 0;
								  chantCount = 0;
								  $("#btnSubmit").css("display","block");
								  
								  chantLimit = $('#txtCount').val(1);
								  var dtNow = new Date();
								  $("#divTimeStop").html(dtNow.getHours() + ":" + dtNow.getMinutes() + ":" + dtNow.getSeconds());
								  $("#diveJapaMala").html("Thank you for chanting. <br><br><span style='font-size:9px'>This window will auto-close in 4 seconds.</span>");
								  $("#spnStopTime").css("display", "block");
								  
								  intPlayListCount = 0;
								  intCurrentPlay = 0;

								  setTimeout(function () {
									  $("#diveJapaMala").html("");
									  $("#spnStopTime").css("display", "none");
									  $.unblockUI();
									  $("#btnSubmit").css("display","block");
								  }, 4000);
					  
								  
							   }
						}
						else if ($("#hidModeOfProcessing").val() == "Special")
						{
						    if (intPlayListCount == intCurrentPlay)
							{
								var dtNow = new Date();
									  $("#divTimeStop").html(dtNow.getHours() + ":" + dtNow.getMinutes() + ":" + dtNow.getSeconds());
									  $("#diveJapaMala").html("Thank you for chanting. <br><br><span style='font-size:9px'>This window will auto-close in 4 seconds.</span>");
									  $("#spnStopTime").css("display", "block");
									  
										intPlayListCount = 0;
										intCurrentPlay = 0;

									  setTimeout(function () {
										  $("#diveJapaMala").html("");
										  $("#spnStopTime").css("display", "none");
										  $.unblockUI();
										  $("#btnSubmit").css("display","block");
									  }, 4000);
							}
						}
		            },
		            error: function (event) {
						intPlayListCount = 0;
						intCurrentPlay = 0;					
					    $("#btnSubmit").css("display","block");
		                $.unblockUI();
		            },
		            swfPath: "./scripts/",
		            cssSelectorAncestor: "#jp_container",
		            supplied: "mp3",
		            wmode: "window"
	            });

	            //$("#jplayer_inspector").jPlayerInspector({jPlayer:$("#jquery_jplayer")});
	
	            $("#btnSubmit").click (function()
	            {
	                    DoChanting();
	            });
	
			});
			   
function DoChanting()
{
    var strMp3 = $("#drpChant").val();
	$("#hidModeOfProcessing").val( (strMp3.indexOf("SPECIALPROCESSING") < 0) ? "Normal":"Special");
	if (strMp3.indexOf("SPECIALPROCESSING") < 0)
	{
		$("#btnSubmit").css("display","none");
		my_jPlayer.jPlayer("setMedia", {mp3: strMp3});    
		chantLimit = $('#txtCount').val();
		FormatText();
		my_jPlayer.jPlayer("play");
		
		var dtNow = new Date();
		$.blockUI({
			message: $("#divTime")
		})
		$("#divTime").css("display","block");
		$("#divTimeStart").html(dtNow.getHours()+":"+dtNow.getMinutes()+":"+dtNow.getSeconds());
	}
	else 
	{
		var urlParts = strMp3.substring(strMp3.indexOf("_")+1);
		
	   	myPlaylist = new jPlayerPlaylist({
		jPlayer: "#jquery_jplayer"
	},{
		swfPath: "./scripts/",
		supplied: "webmv, ogv, m4v, oga, mp3",
		playlistOptions: {
			  autoPlay: false,
			  loopOnPrevious: false,
			  shuffleOnLoop: true,
			  enableRemoveControls: false,
			  displayTime: 'slow',
			  addTime: 'fast',
			  removeTime: 'fast',
			  shuffleTime: 'slow'
		}
	});
	
	   var arrPlayList = (urlParts+"").split(',');
	   
	   for (var j in arrPlayList)
	   {
	       var mp3URLComponent = arrPlayList[j];
		   var mp3Parts = (mp3URLComponent+"").split(':');
		   
		   if (isNaN(mp3Parts[1]))
		      mp3Parts[1] = $('#txtCount').val();

		  for (var i=0;i<mp3Parts[1];i++)
		   {
		           intPlayListCount++;
		   	   	   myPlaylist.add({
			         mp3:mp3Parts[0]
	               });
		   }
   	   }

	   $("#btnSubmit").css("display","none");
	   var dtNow = new Date();
		$.blockUI({
			message: $("#divTime")
		})
		$("#divTime").css("display","block");
		$("#divTimeStart").html(dtNow.getHours()+":"+dtNow.getMinutes()+":"+dtNow.getSeconds());
		
		console.log (myPlaylist);
		
        myPlaylist.play();
   }
}


function FormatText(strText)
{
    if ($("#hidModeOfProcessing").val() == "Special")
	{
	   strText = "Chanting " + ($("#drpChant option:selected").text()+"");
	}
	else 
	{
		strText = "Chanting " + $("#drpChant option:selected").text() +" " +((chantCount++)) + " of " + chantLimit + " time(s)";
	}
	
	$("#diveJapaMala").text(strText);
}

</script>

			
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-35207111-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

<input type="hidden" id="hidModeOfProcessing" name="hidModeOfProcessing">
</body>
</html>